# ğŸš— Order Flow Documentation

## ĞĞ³Ğ»Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ
1. [ĞĞ±Ğ·Ğ¾Ñ€ ÑĞ¸ÑÑ‚ĞµĞ¼Ñ‹](#Ğ¾Ğ±Ğ·Ğ¾Ñ€-ÑĞ¸ÑÑ‚ĞµĞ¼Ñ‹)
2. [Ğ¡Ñ†ĞµĞ½Ğ°Ñ€Ğ¸Ğ¸ ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ñ Ğ·Ğ°ĞºĞ°Ğ·Ğ°](#ÑÑ†ĞµĞ½Ğ°Ñ€Ğ¸Ğ¸-ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ñ-Ğ·Ğ°ĞºĞ°Ğ·Ğ°)
3. [Ğ’Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ñ Frontend](#Ğ²Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ñ-frontend)
4. [Ğ’Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ñ Backend](#Ğ²Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ñ-backend)
5. [Ğ¤ÑƒĞ½ĞºÑ†Ğ¸Ğ¸ Ğ±Ğ°Ğ·Ñ‹ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…](#Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ğ¸-Ğ±Ğ°Ğ·Ñ‹-Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…)
6. [Ğ¡Ñ‚Ğ°Ñ‚ÑƒÑÑ‹ Ğ¾Ñ‚Ğ²ĞµÑ‚Ğ¾Ğ² API](#ÑÑ‚Ğ°Ñ‚ÑƒÑÑ‹-Ğ¾Ñ‚Ğ²ĞµÑ‚Ğ¾Ğ²-api)
7. [Ğ’Ñ€ĞµĞ¼ĞµĞ½Ğ½Ñ‹Ğµ Ğ·Ğ¾Ğ½Ñ‹](#Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ½Ñ‹Ğµ-Ğ·Ğ¾Ğ½Ñ‹)
8. [Ğ”Ğ¸Ğ°Ğ³Ñ€Ğ°Ğ¼Ğ¼Ğ° Ğ¿Ğ¾Ñ‚Ğ¾ĞºĞ°](#Ğ´Ğ¸Ğ°Ğ³Ñ€Ğ°Ğ¼Ğ¼Ğ°-Ğ¿Ğ¾Ñ‚Ğ¾ĞºĞ°)

---

## ĞĞ±Ğ·Ğ¾Ñ€ ÑĞ¸ÑÑ‚ĞµĞ¼Ñ‹

### ĞÑ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ°
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        FRONTEND                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   BookingModal  â”‚  AddOrderModal  â”‚     EditOrderModal          â”‚
â”‚   (ĞšĞ»Ğ¸ĞµĞ½Ñ‚)      â”‚  (ĞĞ´Ğ¼Ğ¸Ğ½)        â”‚     (Ğ ĞµĞ´Ğ°ĞºÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ)        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                 â”‚                       â”‚
         â–¼                 â–¼                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Ğ’ĞĞ›Ğ˜Ğ”ĞĞ¦Ğ˜Ğ¯ (Frontend)                          â”‚
â”‚  â€¢ analyzeDates() - Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ· Ğ·Ğ°Ğ½ÑÑ‚Ñ‹Ñ… Ğ´Ğ°Ñ‚                          â”‚
â”‚  â€¢ MuiTimePicker - Ğ²Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ñ Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ¸                            â”‚
â”‚  â€¢ CalendarPicker - Ğ²Ñ‹Ğ±Ğ¾Ñ€ Ğ¸ Ğ±Ğ»Ğ¾ĞºĞ¸Ñ€Ğ¾Ğ²ĞºĞ° Ğ´Ğ°Ñ‚                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      API ROUTES                                  â”‚
â”‚  POST /api/order/add        - ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Ğ·Ğ°ĞºĞ°Ğ·Ğ°                   â”‚
â”‚  PUT  /api/order/update/*   - Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ğ·Ğ°ĞºĞ°Ğ·Ğ°                 â”‚
â”‚  GET  /api/order/confirmed  - Ğ¿Ğ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ğµ Ğ¿Ğ¾Ğ´Ñ‚Ğ²ĞµÑ€Ğ¶Ğ´Ñ‘Ğ½Ğ½Ñ‹Ñ…          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Ğ’ĞĞ›Ğ˜Ğ”ĞĞ¦Ğ˜Ğ¯ (Backend)                           â”‚
â”‚  â€¢ checkConflicts() - Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ğ¿ĞµÑ€ĞµÑĞµÑ‡ĞµĞ½Ğ¸Ğ¹                      â”‚
â”‚  â€¢ Mongoose middleware (pre-save hooks)                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      MongoDB                                     â”‚
â”‚  Collections: orders, cars, companies                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Ğ¡Ñ†ĞµĞ½Ğ°Ñ€Ğ¸Ğ¸ ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ñ Ğ·Ğ°ĞºĞ°Ğ·Ğ°

### 1. ğŸ‘¤ ĞšĞ»Ğ¸ĞµĞ½Ñ‚ (BookingModal)

**Ğ¤Ğ°Ğ¹Ğ»:** `app/components/CarComponent/BookingModal.js`

| Ğ­Ñ‚Ğ°Ğ¿ | Ğ”ĞµĞ¹ÑÑ‚Ğ²Ğ¸Ğµ | Ğ’Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ñ |
|------|----------|-----------|
| 1 | Ğ’Ñ‹Ğ±Ğ¾Ñ€ Ğ´Ğ°Ñ‚ Ğ² CalendarPicker | Ğ‘Ğ»Ğ¾ĞºĞ¸Ñ€Ğ¾Ğ²ĞºĞ° confirmed Ğ´Ğ°Ñ‚ |
| 2 | Ğ’Ñ‹Ğ±Ğ¾Ñ€ Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ¸ | ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸ Â±2Ñ‡ Ğ¾Ñ‚ ÑĞ¾ÑĞµĞ´Ğ½Ğ¸Ñ… Ğ·Ğ°ĞºĞ°Ğ·Ğ¾Ğ² |
| 3 | Ğ—Ğ°Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¸Ğµ Ñ„Ğ¾Ñ€Ğ¼Ñ‹ | Ğ˜Ğ¼Ñ, Ñ‚ĞµĞ»ĞµÑ„Ğ¾Ğ½, email Ğ¾Ğ±ÑĞ·Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ñ‹ |
| 4 | ĞÑ‚Ğ¿Ñ€Ğ°Ğ²ĞºĞ° | `confirmed: false` Ğ¿Ğ¾ ÑƒĞ¼Ğ¾Ğ»Ñ‡Ğ°Ğ½Ğ¸Ñ |

**ĞÑĞ¾Ğ±ĞµĞ½Ğ½Ğ¾ÑÑ‚Ğ¸:**
- Ğ—Ğ°ĞºĞ°Ğ· ÑĞ¾Ğ·Ğ´Ğ°Ñ‘Ñ‚ÑÑ ĞºĞ°Ğº **ĞĞ•ĞŸĞĞ”Ğ¢Ğ’Ğ•Ğ Ğ–Ğ”ĞĞĞĞ«Ğ™** (`confirmed: false`)
- ĞšĞ»Ğ¸ĞµĞ½Ñ‚ ĞĞ• Ğ²Ğ¸Ğ´Ğ¸Ñ‚ Ğ½ĞµĞ¿Ğ¾Ğ´Ñ‚Ğ²ĞµÑ€Ğ¶Ğ´Ñ‘Ğ½Ğ½Ñ‹Ğµ Ğ·Ğ°ĞºĞ°Ğ·Ñ‹ Ğ´Ñ€ÑƒĞ³Ğ¸Ñ… ĞºĞ»Ğ¸ĞµĞ½Ñ‚Ğ¾Ğ²
- Ğ’Ğ¸Ğ´Ğ¸Ñ‚ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ "Ğ¿Ğ¾Ğ»Ğ½Ğ¾ÑÑ‚ÑŒÑ Ğ·Ğ°Ğ½ÑÑ‚Ñ‹Ğµ" (confirmed) Ğ´Ğ°Ñ‚Ñ‹

```javascript
// BookingModal - Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ¿Ñ€Ğ¸ Ğ¾Ñ‚Ğ¿Ñ€Ğ°Ğ²ĞºĞµ
{
  confirmed: false,  // Ğ’Ğ¡Ğ•Ğ“Ğ”Ğ false Ğ´Ğ»Ñ ĞºĞ»Ğ¸ĞµĞ½Ñ‚Ğ°
  my_order: false,   // Ğ½Ğµ "Ğ²Ğ½ÑƒÑ‚Ñ€ĞµĞ½Ğ½Ğ¸Ğ¹" Ğ·Ğ°ĞºĞ°Ğ·
  // ... Ğ¾ÑÑ‚Ğ°Ğ»ÑŒĞ½Ñ‹Ğµ Ğ¿Ğ¾Ğ»Ñ
}
```

---

### 2. ğŸ‘¨â€ğŸ’¼ ĞĞ´Ğ¼Ğ¸Ğ½ (AddOrderModal)

**Ğ¤Ğ°Ğ¹Ğ»:** `app/components/Admin/Order/AddOrderModal.js`

| Ğ­Ñ‚Ğ°Ğ¿ | Ğ”ĞµĞ¹ÑÑ‚Ğ²Ğ¸Ğµ | Ğ’Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ñ |
|------|----------|-----------|
| 1 | Ğ’Ñ‹Ğ±Ğ¾Ñ€ Ğ¼Ğ°ÑˆĞ¸Ğ½Ñ‹ | Ğ”Ğ¾ÑÑ‚ÑƒĞ¿Ğ½Ñ‹ Ğ²ÑĞµ Ğ¼Ğ°ÑˆĞ¸Ğ½Ñ‹ ĞºĞ¾Ğ¼Ğ¿Ğ°Ğ½Ğ¸Ğ¸ |
| 2 | Ğ’Ñ‹Ğ±Ğ¾Ñ€ Ğ´Ğ°Ñ‚ | Ğ’Ğ¸Ğ´Ğ¸Ñ‚ Ğ’Ğ¡Ğ• Ğ·Ğ°ĞºĞ°Ğ·Ñ‹ (confirmed + pending) |
| 3 | Ğ’Ñ‹Ğ±Ğ¾Ñ€ Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ¸ | Ğ’Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ñ Ğ¿ĞµÑ€ĞµÑĞµÑ‡ĞµĞ½Ğ¸Ğ¹ |
| 4 | Ğ¡Ñ‚Ğ°Ñ‚ÑƒÑ Ğ¿Ğ¾Ğ´Ñ‚Ğ²ĞµÑ€Ğ¶Ğ´ĞµĞ½Ğ¸Ñ | ĞœĞ¾Ğ¶ĞµÑ‚ Ğ²Ñ‹Ğ±Ñ€Ğ°Ñ‚ÑŒ confirmed: true/false |
| 5 | ĞÑ‚Ğ¿Ñ€Ğ°Ğ²ĞºĞ° | Ğ¡ Ğ¿Ğ¾Ğ»Ğ½Ñ‹Ğ¼ ĞºĞ¾Ğ½Ñ‚Ñ€Ğ¾Ğ»ĞµĞ¼ |

**ĞÑĞ¾Ğ±ĞµĞ½Ğ½Ğ¾ÑÑ‚Ğ¸:**
- Ğ’Ğ¸Ğ´Ğ¸Ñ‚ **Ğ’Ğ¡Ğ• Ğ·Ğ°ĞºĞ°Ğ·Ñ‹** (Ğ¿Ğ¾Ğ´Ñ‚Ğ²ĞµÑ€Ğ¶Ğ´Ñ‘Ğ½Ğ½Ñ‹Ğµ Ğ¸ Ğ¾Ğ¶Ğ¸Ğ´Ğ°ÑÑ‰Ğ¸Ğµ)
- ĞœĞ¾Ğ¶ĞµÑ‚ ÑÑ€Ğ°Ğ·Ñƒ Ğ¿Ğ¾Ğ´Ñ‚Ğ²ĞµÑ€Ğ´Ğ¸Ñ‚ÑŒ Ğ·Ğ°ĞºĞ°Ğ·
- ĞœĞ¾Ğ¶ĞµÑ‚ Ğ¾Ñ‚Ğ¼ĞµÑ‚Ğ¸Ñ‚ÑŒ ĞºĞ°Ğº "Ğ²Ğ½ÑƒÑ‚Ñ€ĞµĞ½Ğ½Ğ¸Ğ¹" (`my_order: true`)
- ĞŸĞ¾Ğ»ÑƒÑ‡Ğ°ĞµÑ‚ Ğ¿Ñ€ĞµĞ´ÑƒĞ¿Ñ€ĞµĞ¶Ğ´ĞµĞ½Ğ¸Ñ Ğ¾ Ğ¿ĞµÑ€ĞµÑĞµÑ‡ĞµĞ½Ğ¸ÑÑ…

```javascript
// AddOrderModal (Ğ°Ğ´Ğ¼Ğ¸Ğ½) - Ñ€Ğ°ÑÑˆĞ¸Ñ€ĞµĞ½Ğ½Ñ‹Ğµ Ğ¾Ğ¿Ñ†Ğ¸Ğ¸
{
  confirmed: true/false,  // Ğ’Ñ‹Ğ±Ğ¾Ñ€ Ğ°Ğ´Ğ¼Ğ¸Ğ½Ğ°
  my_order: true/false,   // Ğ’Ğ½ÑƒÑ‚Ñ€ĞµĞ½Ğ½Ğ¸Ğ¹ Ğ·Ğ°ĞºĞ°Ğ·
  insurance: "TPL"/"FDW"/"SCDW", // Ğ¡Ñ‚Ñ€Ğ°Ñ…Ğ¾Ğ²ĞºĞ°
  ChildSeats: 0-3,        // Ğ”ĞµÑ‚ÑĞºĞ¸Ğµ ĞºÑ€ĞµÑĞ»Ğ°
  franchiseOrder: number, // Ğ¤Ñ€Ğ°Ğ½ÑˆĞ¸Ğ·Ğ°
}
```

---

### 3. ğŸ‘‘ Ğ¡ÑƒĞ¿ĞµÑ€Ğ°Ğ´Ğ¼Ğ¸Ğ½ (Ğ Ğ°ÑÑˆĞ¸Ñ€ĞµĞ½Ğ½Ñ‹Ğµ Ğ¿Ñ€Ğ°Ğ²Ğ°)

**Ğ¤Ğ°Ğ¹Ğ»:** Ğ¢Ğ¾Ñ‚ Ğ¶Ğµ `AddOrderModal.js` Ğ½Ğ¾ Ñ Ğ´Ğ¾Ğ¿Ğ¾Ğ»Ğ½Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ñ‹Ğ¼Ğ¸ Ğ¿Ñ€Ğ°Ğ²Ğ°Ğ¼Ğ¸

| Ğ¤ÑƒĞ½ĞºÑ†Ğ¸Ñ | Ğ”Ğ¾ÑÑ‚ÑƒĞ¿ |
|---------|--------|
| Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Ğ·Ğ°ĞºĞ°Ğ·Ğ¾Ğ² | âœ… Ğ’ÑĞµ Ğ¼Ğ°ÑˆĞ¸Ğ½Ñ‹ Ğ²ÑĞµÑ… ĞºĞ¾Ğ¼Ğ¿Ğ°Ğ½Ğ¸Ğ¹ |
| Ğ˜Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ğµ Ñ†ĞµĞ½ | âœ… ĞŸÑ€ÑĞ¼Ğ¾Ğµ Ñ€ĞµĞ´Ğ°ĞºÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ totalPrice |
| Ğ£Ğ´Ğ°Ğ»ĞµĞ½Ğ¸Ğµ Ğ·Ğ°ĞºĞ°Ğ·Ğ¾Ğ² | âœ… Ğ›ÑĞ±Ñ‹Ğµ, Ğ²ĞºĞ»ÑÑ‡Ğ°Ñ Ğ¿Ğ¾Ğ´Ñ‚Ğ²ĞµÑ€Ğ¶Ğ´Ñ‘Ğ½Ğ½Ñ‹Ğµ |
| ĞŸĞµÑ€ĞµĞ½Ğ°Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ Ğ¼Ğ°ÑˆĞ¸Ğ½ | âœ… ĞœĞµĞ¶Ğ´Ñƒ ĞºĞ¾Ğ¼Ğ¿Ğ°Ğ½Ğ¸ÑĞ¼Ğ¸ |
| Ğ˜Ğ³Ğ½Ğ¾Ñ€Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ ĞºĞ¾Ğ½Ñ„Ğ»Ğ¸ĞºÑ‚Ğ¾Ğ² | âœ… ĞŸÑ€Ğ¸Ğ½ÑƒĞ´Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾Ğµ ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ |

**Ğ ĞµĞºĞ¾Ğ¼ĞµĞ½Ğ´ÑƒĞµĞ¼Ñ‹Ğµ Ñ€Ğ°ÑÑˆĞ¸Ñ€ĞµĞ½Ğ¸Ñ:**
```javascript
// Ğ”Ğ¾Ğ¿Ğ¾Ğ»Ğ½Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ñ‹Ğµ Ğ¿Ğ¾Ğ»Ñ Ğ´Ğ»Ñ ÑÑƒĞ¿ĞµÑ€Ğ°Ğ´Ğ¼Ğ¸Ğ½Ğ°
{
  forceCreate: true,      // Ğ˜Ğ³Ğ½Ğ¾Ñ€Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ ĞºĞ¾Ğ½Ñ„Ğ»Ğ¸ĞºÑ‚Ñ‹
  overridePrice: true,    // Ğ ÑƒÑ‡Ğ½Ğ°Ñ Ñ†ĞµĞ½Ğ°
  crossCompany: true,     // ĞœĞµĞ¶Ğ´Ñƒ ĞºĞ¾Ğ¼Ğ¿Ğ°Ğ½Ğ¸ÑĞ¼Ğ¸
  auditLog: true,         // Ğ›Ğ¾Ğ³Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ´ĞµĞ¹ÑÑ‚Ğ²Ğ¸Ñ
}
```

---

## Ğ’Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ñ Frontend

### 1. ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ğ´Ğ°Ñ‚ (`analyzeDates.js`)

```javascript
// utils/analyzeDates.js

function analyzeDates(orders) {
  // Ğ’Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‰Ğ°ĞµÑ‚:
  return {
    confirmed: [{ date, isStart, isEnd, timeStart, timeEnd, orderId }],
    pending: [{ date, isStart, isEnd, timeStart, timeEnd, orderId }]
  };
}
```

**Ğ›Ğ¾Ğ³Ğ¸ĞºĞ°:**
1. ĞŸÑ€Ğ¾Ñ…Ğ¾Ğ´Ğ¸Ñ‚ Ğ¿Ğ¾ Ğ²ÑĞµĞ¼ Ğ·Ğ°ĞºĞ°Ğ·Ğ°Ğ¼ Ğ¼Ğ°ÑˆĞ¸Ğ½Ñ‹
2. Ğ”Ğ»Ñ ĞºĞ°Ğ¶Ğ´Ğ¾Ğ³Ğ¾ Ğ´Ğ½Ñ Ğ´Ğ¸Ğ°Ğ¿Ğ°Ğ·Ğ¾Ğ½Ğ° ÑĞ¾Ğ·Ğ´Ğ°Ñ‘Ñ‚ Ğ¾Ğ±ÑŠĞµĞºÑ‚ Ñ Ğ¼ĞµÑ‚Ğ°Ğ´Ğ°Ğ½Ğ½Ñ‹Ğ¼Ğ¸
3. ĞŸĞ¾Ğ¼ĞµÑ‡Ğ°ĞµÑ‚ start/end Ğ´Ğ½Ğ¸ Ğ´Ğ»Ñ Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºĞ¸ Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ¸
4. Ğ¡Ñ‡Ğ¸Ñ‚Ğ°ĞµÑ‚ overlaps (Ğ¿ĞµÑ€ĞµÑĞµÑ‡ĞµĞ½Ğ¸Ñ)

### 2. ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° ĞºĞ¾Ğ½Ñ„Ğ»Ğ¸ĞºÑ‚Ğ¾Ğ² Ğ´Ğ°Ñ‚

```javascript
// utils/analyzeDates.js

function checkConflicts(existingOrders, startDate, endDate, timeIn, timeOut) {
  // ĞŸĞĞ Ğ¯Ğ”ĞĞš ĞŸĞ ĞĞ’Ğ•Ğ ĞĞš:
  
  // 1. Confirmed Ğ´Ğ°Ñ‚Ñ‹ Ğ’ĞĞ£Ğ¢Ğ Ğ˜ Ğ´Ğ¸Ğ°Ğ¿Ğ°Ğ·Ğ¾Ğ½Ğ° â†’ 409 (Ğ‘Ğ›ĞĞš)
  const confirmedInnerDates = result.confirmed.filter(
    (item) => !item.isStart && !item.isEnd && 
              item.datejs.isBetween(startDate, endDate)
  );
  
  // 2. ĞšĞ¾Ğ½Ñ„Ğ»Ğ¸ĞºÑ‚ Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ¸ Ğ½Ğ° Ğ³Ñ€Ğ°Ğ½Ğ¸Ñ‡Ğ½Ñ‹Ñ… Ğ´Ğ°Ñ‚Ğ°Ñ… â†’ 408 (Ğ¿Ñ€ĞµĞ´ÑƒĞ¿Ñ€ĞµĞ¶Ğ´ĞµĞ½Ğ¸Ğµ)
  const isStartTimeConflict = checkStartTimeOverlap();
  const isEndTimeConflict = checkEndTimeOverlap();
  
  // 3. Pending Ğ´Ğ°Ñ‚Ñ‹ Ğ’ĞĞ£Ğ¢Ğ Ğ˜ Ğ´Ğ¸Ğ°Ğ¿Ğ°Ğ·Ğ¾Ğ½Ğ° â†’ 202 (Ğ¿Ñ€ĞµĞ´ÑƒĞ¿Ñ€ĞµĞ¶Ğ´ĞµĞ½Ğ¸Ğµ)
  const pendingInnerDates = result.pending.filter(...);
}
```

### 3. ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ¸ (`MuiTimePicker.js`)

```javascript
// app/components/Calendars/MuiTimePicker.js

// ĞŸÑ€Ğ°Ğ²Ğ¸Ğ»Ğ¾ 1: Ğ’Ñ€ĞµĞ¼Ñ Ğ¿Ğ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ñ >= Ğ’Ñ€ĞµĞ¼Ñ Ğ²Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‚Ğ° Ğ¿Ñ€ĞµĞ´Ñ‹Ğ´ÑƒÑ‰ĞµĞ³Ğ¾ Ğ·Ğ°ĞºĞ°Ğ·Ğ°
validateStartTime() {
  if (newStartTime.isBefore(previousOrderEndTime)) {
    return { isValid: false, message: "..." };
  }
}

// ĞŸÑ€Ğ°Ğ²Ğ¸Ğ»Ğ¾ 2: Ğ’Ñ€ĞµĞ¼Ñ Ğ²Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‚Ğ° <= Ğ’Ñ€ĞµĞ¼Ñ Ğ¿Ğ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ñ ÑĞ»ĞµĞ´ÑƒÑÑ‰ĞµĞ³Ğ¾ Ğ·Ğ°ĞºĞ°Ğ·Ğ°
validateEndTime() {
  if (newEndTime.isAfter(nextOrderStartTime)) {
    return { isValid: false, message: "..." };
  }
}
```

### 4. Ğ‘Ğ»Ğ¾ĞºĞ¸Ñ€Ğ¾Ğ²ĞºĞ° Ğ´Ğ°Ñ‚ Ğ² ĞºĞ°Ğ»ĞµĞ½Ğ´Ğ°Ñ€Ğµ (`CalendarPicker.js`)

```javascript
// app/components/CarComponent/CalendarPicker.js

// Ğ”Ğ»Ñ ĞºĞ»Ğ¸ĞµĞ½Ñ‚Ğ°: Ğ±Ğ»Ğ¾ĞºĞ¸Ñ€ÑƒÑÑ‚ÑÑ Ğ¢ĞĞ›Ğ¬ĞšĞ confirmed Ğ´Ğ°Ñ‚Ñ‹
const confirmedDates = startEndDates
  .filter(d => d.confirmed)
  .map(d => d.date);

// Ğ”Ğ»Ñ Ğ°Ğ´Ğ¼Ğ¸Ğ½Ğ°: Ğ¿Ğ¾ĞºĞ°Ğ·Ñ‹Ğ²Ğ°ÑÑ‚ÑÑ Ğ’Ğ¡Ğ• Ğ´Ğ°Ñ‚Ñ‹ Ñ Ñ†Ğ²ĞµÑ‚Ğ¾Ğ²Ğ¾Ğ¹ Ğ¸Ğ½Ğ´Ğ¸ĞºĞ°Ñ†Ğ¸ĞµĞ¹
// - ĞšÑ€Ğ°ÑĞ½Ñ‹Ğ¹: confirmed
// - Ğ–Ñ‘Ğ»Ñ‚Ñ‹Ğ¹: pending
// - Ğ—ĞµĞ»Ñ‘Ğ½Ñ‹Ğ¹: ÑĞ²Ğ¾Ğ±Ğ¾Ğ´Ğ½Ğ¾
```

---

## Ğ’Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ñ Backend

### API Route: `/api/order/add/route.js`

```javascript
export async function POST(request) {
  // 1. Ğ‘ĞĞ—ĞĞ’Ğ«Ğ• ĞŸĞ ĞĞ’Ğ•Ğ ĞšĞ˜
  
  // 1.1. ĞĞ´Ğ¸Ğ½Ğ°ĞºĞ¾Ğ²Ñ‹Ğµ Ğ´Ğ°Ñ‚Ñ‹
  if (startDate.isSame(endDate, "day")) {
    return Response({ status: 405 });
  }
  
  // 1.2. ĞœĞ°ÑˆĞ¸Ğ½Ğ° ÑÑƒÑ‰ĞµÑÑ‚Ğ²ÑƒĞµÑ‚
  const existingCar = await Car.findOne({ carNumber });
  if (!existingCar) {
    return Response({ status: 404 });
  }
  
  // 2. ĞŸĞ ĞĞ’Ğ•Ğ ĞšĞ ĞšĞĞĞ¤Ğ›Ğ˜ĞšĞ¢ĞĞ’
  const { status, data } = checkConflicts(
    existingOrders, startDate, endDate, timeIn, timeOut
  );
  
  switch (status) {
    case 409: // Confirmed ĞºĞ¾Ğ½Ñ„Ğ»Ğ¸ĞºÑ‚ - ĞĞ• ÑĞ¾Ğ·Ğ´Ğ°Ñ‘Ğ¼
      return Response({ status: 409, conflictDates });
      
    case 408: // ĞšĞ¾Ğ½Ñ„Ğ»Ğ¸ĞºÑ‚ Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ¸ - ÑĞ¾Ğ·Ğ´Ğ°Ñ‘Ğ¼ Ñ ÑƒĞ²ĞµĞ´Ğ¾Ğ¼Ğ»ĞµĞ½Ğ¸ĞµĞ¼
      // âš ï¸ Ğ¢Ğ•ĞšĞ£Ğ©Ğ•Ğ• ĞŸĞĞ’Ğ•Ğ”Ğ•ĞĞ˜Ğ•: Ğ·Ğ°ĞºĞ°Ğ· ÑĞ¾Ğ·Ğ´Ğ°Ñ‘Ñ‚ÑÑ
      break;
      
    case 202: // Pending ĞºĞ¾Ğ½Ñ„Ğ»Ğ¸ĞºÑ‚ - ÑĞ¾Ğ·Ğ´Ğ°Ñ‘Ğ¼ Ñ Ğ¿Ñ€ĞµĞ´ÑƒĞ¿Ñ€ĞµĞ¶Ğ´ĞµĞ½Ğ¸ĞµĞ¼
      // Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½ÑĞµĞ¼ IDs ĞºĞ¾Ğ½Ñ„Ğ»Ğ¸ĞºÑ‚ÑƒÑÑ‰Ğ¸Ñ… Ğ·Ğ°ĞºĞ°Ğ·Ğ¾Ğ²
      conflictOrdersId = data.conflictOrdersIds;
      break;
  }
  
  // 3. Ğ ĞĞ¡Ğ§ĞĞ¢ Ğ¦Ğ•ĞĞ«
  const { total, days } = await car.calculateTotalRentalPricePerDay(
    startDate, endDate, insurance, ChildSeats
  );
  
  // 4. Ğ¡ĞĞ—Ğ”ĞĞĞ˜Ğ• Ğ—ĞĞšĞĞ—Ğ
  const newOrder = new Order({...});
  await newOrder.save();
  
  // 5. Ğ£Ğ’Ğ•Ğ”ĞĞœĞ›Ğ•ĞĞ˜Ğ• (ĞµÑĞ»Ğ¸ ĞµÑÑ‚ÑŒ pending ĞºĞ¾Ğ½Ñ„Ğ»Ğ¸ĞºÑ‚Ñ‹)
  if (conflictOrdersId.length > 0) {
    // TODO: ĞÑ‚Ğ¿Ñ€Ğ°Ğ²Ğ¸Ñ‚ÑŒ ÑƒĞ²ĞµĞ´Ğ¾Ğ¼Ğ»ĞµĞ½Ğ¸Ğµ Ğ²Ğ»Ğ°Ğ´ĞµĞ»ÑŒÑ†Ğ°Ğ¼ ĞºĞ¾Ğ½Ñ„Ğ»Ğ¸ĞºÑ‚ÑƒÑÑ‰Ğ¸Ñ… Ğ·Ğ°ĞºĞ°Ğ·Ğ¾Ğ²
  }
}
```

---

## Ğ¤ÑƒĞ½ĞºÑ†Ğ¸Ğ¸ Ğ±Ğ°Ğ·Ñ‹ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…

### Ğ¢ĞµĞºÑƒÑ‰Ğ¸Ğµ Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ğ¸ Ğ² Ğ¼Ğ¾Ğ´ĞµĞ»Ğ¸ Car

```javascript
// models/car.js

// Ğ Ğ°ÑÑ‡Ñ‘Ñ‚ Ñ†ĞµĞ½Ñ‹ Ğ°Ñ€ĞµĞ½Ğ´Ñ‹
carSchema.methods.calculateTotalRentalPricePerDay = async function(
  startDate, endDate, insurance, childSeats
) {
  // Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµÑ‚ pricing tiers Ğ¿Ğ¾ ĞºĞ¾Ğ»Ğ¸Ñ‡ĞµÑÑ‚Ğ²Ñƒ Ğ´Ğ½ĞµĞ¹
  // Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ»ÑĞµÑ‚ ÑÑ‚Ğ¾Ğ¸Ğ¼Ğ¾ÑÑ‚ÑŒ ÑÑ‚Ñ€Ğ°Ñ…Ğ¾Ğ²ĞºĞ¸ Ğ¸ Ğ´ĞµÑ‚ÑĞºĞ¸Ñ… ĞºÑ€ĞµÑĞµĞ»
  return { total, days };
};
```

### âš¡ Ğ ĞµĞºĞ¾Ğ¼ĞµĞ½Ğ´ÑƒĞµĞ¼Ñ‹Ğµ Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ğ¸ Ğ´Ğ»Ñ Ğ´Ğ¾Ğ±Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ñ

```javascript
// models/order.js - Ğ Ğ•ĞšĞĞœĞ•ĞĞ”ĞĞ¦Ğ˜Ğ˜

// 1. Pre-save hook Ğ´Ğ»Ñ Ğ²Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ğ¸
orderSchema.pre('save', async function(next) {
  // ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° ĞºĞ¾Ğ½Ñ„Ğ»Ğ¸ĞºÑ‚Ğ¾Ğ² Ğ¿ĞµÑ€ĞµĞ´ ÑĞ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ¸ĞµĞ¼
  const conflicts = await this.checkConflictsBeforeSave();
  if (conflicts.hasBlockingConflict) {
    throw new Error('Blocking conflict detected');
  }
  next();
});

// 2. Ğ¡Ñ‚Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¹ Ğ¼ĞµÑ‚Ğ¾Ğ´ Ğ´Ğ»Ñ Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºĞ¸ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ½Ğ¾ÑÑ‚Ğ¸
orderSchema.statics.checkAvailability = async function(carId, startDate, endDate) {
  const conflictingOrders = await this.find({
    car: carId,
    confirmed: true,
    $or: [
      { rentalStartDate: { $lte: endDate }, rentalEndDate: { $gte: startDate } }
    ]
  });
  return conflictingOrders.length === 0;
};

// 3. Ğ’Ğ¸Ñ€Ñ‚ÑƒĞ°Ğ»ÑŒĞ½Ğ¾Ğµ Ğ¿Ğ¾Ğ»Ğµ Ğ´Ğ»Ñ ÑÑ‚Ğ°Ñ‚ÑƒÑĞ°
orderSchema.virtual('status').get(function() {
  const now = dayjs();
  if (now.isBefore(this.rentalStartDate)) return 'upcoming';
  if (now.isAfter(this.rentalEndDate)) return 'completed';
  return 'active';
});

// 4. ĞœĞµÑ‚Ğ¾Ğ´ Ğ´Ğ»Ñ Ğ¿Ğ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ñ ÑĞ¾ÑĞµĞ´Ğ½Ğ¸Ñ… Ğ·Ğ°ĞºĞ°Ğ·Ğ¾Ğ²
orderSchema.statics.getAdjacentOrders = async function(carId, date) {
  const previousOrder = await this.findOne({
    car: carId,
    rentalEndDate: { $lte: date },
    confirmed: true
  }).sort({ rentalEndDate: -1 });
  
  const nextOrder = await this.findOne({
    car: carId,
    rentalStartDate: { $gte: date },
    confirmed: true
  }).sort({ rentalStartDate: 1 });
  
  return { previousOrder, nextOrder };
};
```

---

## Ğ¡Ñ‚Ğ°Ñ‚ÑƒÑÑ‹ Ğ¾Ñ‚Ğ²ĞµÑ‚Ğ¾Ğ² API

### Ğ¢ĞµĞºÑƒÑ‰Ğ¸Ğµ ÑÑ‚Ğ°Ñ‚ÑƒÑÑ‹

| Ğ¡Ñ‚Ğ°Ñ‚ÑƒÑ | ĞĞ°Ğ·Ğ²Ğ°Ğ½Ğ¸Ğµ | ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ | Ğ—Ğ°ĞºĞ°Ğ· ÑĞ¾Ğ·Ğ´Ğ°Ğ½? |
|--------|----------|----------|---------------|
| **200** | Success | Ğ—Ğ°ĞºĞ°Ğ· ÑƒÑĞ¿ĞµÑˆĞ½Ğ¾ ÑĞ¾Ğ·Ğ´Ğ°Ğ½ | âœ… Ğ”Ğ° |
| **202** | Pending Conflict | Ğ•ÑÑ‚ÑŒ Ğ¿ĞµÑ€ĞµÑĞµÑ‡ĞµĞ½Ğ¸Ñ Ñ pending Ğ·Ğ°ĞºĞ°Ğ·Ğ°Ğ¼Ğ¸ | âœ… Ğ”Ğ° |
| **404** | Car Not Found | ĞœĞ°ÑˆĞ¸Ğ½Ğ° Ğ½Ğµ Ğ½Ğ°Ğ¹Ğ´ĞµĞ½Ğ° | âŒ ĞĞµÑ‚ |
| **405** | Same Date | ĞĞ°Ñ‡Ğ°Ğ»Ğ¾ Ğ¸ ĞºĞ¾Ğ½ĞµÑ† Ğ² Ğ¾Ğ´Ğ¸Ğ½ Ğ´ĞµĞ½ÑŒ | âŒ ĞĞµÑ‚ |
| **408** | Time Conflict | ĞšĞ¾Ğ½Ñ„Ğ»Ğ¸ĞºÑ‚ Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ¸ Ğ½Ğ° Ğ³Ñ€Ğ°Ğ½Ğ¸Ñ‡Ğ½Ñ‹Ñ… Ğ´Ğ°Ñ‚Ğ°Ñ… | âš ï¸ Ğ”Ğ° (Ğ²Ğ¾Ğ·Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ Ğ±Ğ°Ğ³) |
| **409** | Confirmed Conflict | ĞšĞ¾Ğ½Ñ„Ğ»Ğ¸ĞºÑ‚ Ñ Ğ¿Ğ¾Ğ´Ñ‚Ğ²ĞµÑ€Ğ¶Ğ´Ñ‘Ğ½Ğ½Ñ‹Ğ¼ Ğ·Ğ°ĞºĞ°Ğ·Ğ¾Ğ¼ | âŒ ĞĞµÑ‚ |

### âš¡ Ğ ĞµĞºĞ¾Ğ¼ĞµĞ½Ğ´ÑƒĞµĞ¼Ñ‹Ğµ ÑÑ‚Ğ°Ñ‚ÑƒÑÑ‹ Ğ´Ğ»Ñ Ğ´Ğ¾Ğ±Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ñ

| Ğ¡Ñ‚Ğ°Ñ‚ÑƒÑ | ĞĞ°Ğ·Ğ²Ğ°Ğ½Ğ¸Ğµ | ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ | Ğ—Ğ°ĞºĞ°Ğ· ÑĞ¾Ğ·Ğ´Ğ°Ğ½? |
|--------|----------|----------|---------------|
| **201** | Created | Ğ—Ğ°ĞºĞ°Ğ· ÑĞ¾Ğ·Ğ´Ğ°Ğ½ (ÑÑ‚Ğ°Ğ½Ğ´Ğ°Ñ€Ñ‚Ğ½Ñ‹Ğ¹ REST) | âœ… Ğ”Ğ° |
| **400** | Bad Request | ĞĞµĞ²Ğ°Ğ»Ğ¸Ğ´Ğ½Ñ‹Ğµ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ Ñ„Ğ¾Ñ€Ğ¼Ñ‹ | âŒ ĞĞµÑ‚ |
| **401** | Unauthorized | ĞŸĞ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒ Ğ½Ğµ Ğ°Ğ²Ñ‚Ğ¾Ñ€Ğ¸Ğ·Ğ¾Ğ²Ğ°Ğ½ | âŒ ĞĞµÑ‚ |
| **403** | Forbidden | ĞĞµÑ‚ Ğ¿Ñ€Ğ°Ğ² Ğ½Ğ° Ğ¾Ğ¿ĞµÑ€Ğ°Ñ†Ğ¸Ñ | âŒ ĞĞµÑ‚ |
| **422** | Validation Error | ĞÑˆĞ¸Ğ±ĞºĞ° Ğ²Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ğ¸ | âŒ ĞĞµÑ‚ |
| **429** | Too Many Requests | Rate limiting | âŒ ĞĞµÑ‚ |
| **503** | Service Unavailable | Ğ‘Ğ” Ğ½ĞµĞ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ½Ğ° | âŒ ĞĞµÑ‚ |

### Ğ¡Ñ‚Ğ°Ğ½Ğ´Ğ°Ñ€Ñ‚Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Ğ¾Ñ‚Ğ²ĞµÑ‚Ğ¾Ğ²

```javascript
// Ğ ĞµĞºĞ¾Ğ¼ĞµĞ½Ğ´ÑƒĞµĞ¼Ğ°Ñ ÑÑ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ° Ğ¾Ñ‚Ğ²ĞµÑ‚Ğ° API
{
  success: boolean,
  status: number,
  code: string,           // ĞœĞ°ÑˆĞ¸Ğ½Ğ½Ñ‹Ğ¹ ĞºĞ¾Ğ´: "ORDER_CREATED", "CONFLICT_CONFIRMED"
  message: string,        // Ğ§ĞµĞ»Ğ¾Ğ²ĞµĞºĞ¾Ñ‡Ğ¸Ñ‚Ğ°ĞµĞ¼Ğ¾Ğµ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğµ
  data: {
    order?: Order,        // Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ½Ñ‹Ğ¹ Ğ·Ğ°ĞºĞ°Ğ· (ĞµÑĞ»Ğ¸ ÑƒÑĞ¿ĞµÑ…)
    conflicts?: [],       // Ğ¡Ğ¿Ğ¸ÑĞ¾Ğº ĞºĞ¾Ğ½Ñ„Ğ»Ğ¸ĞºÑ‚Ğ¾Ğ² (ĞµÑĞ»Ğ¸ ĞµÑÑ‚ÑŒ)
    warnings?: [],        // ĞŸÑ€ĞµĞ´ÑƒĞ¿Ñ€ĞµĞ¶Ğ´ĞµĞ½Ğ¸Ñ
  },
  meta: {
    timestamp: Date,
    requestId: string,
  }
}
```

---

## Ğ’Ñ€ĞµĞ¼ĞµĞ½Ğ½Ñ‹Ğµ Ğ·Ğ¾Ğ½Ñ‹

### ğŸ¯ ĞŸÑ€Ğ¸Ğ½Ñ†Ğ¸Ğ¿: "Ğ’Ñ€ĞµĞ¼Ñ ĞºĞ°Ğº Ñƒ Ğ°Ğ²Ğ¸Ğ°Ğ±Ğ¸Ğ»ĞµÑ‚Ğ¾Ğ²"

**ĞŸÑ€Ğ°Ğ²Ğ¸Ğ»Ğ¾:** Ğ’ÑÑ‘ Ğ²Ñ€ĞµĞ¼Ñ Ğ² ÑĞ¸ÑÑ‚ĞµĞ¼Ğµ = **Ğ“Ñ€ĞµÑ‡ĞµÑĞºĞ¾Ğµ Ğ²Ñ€ĞµĞ¼Ñ (Europe/Athens)**

```
ĞšĞ»Ğ¸ĞµĞ½Ñ‚ Ğ² Ğ¡Ğ¨Ğ Ğ²Ğ¸Ğ´Ğ¸Ñ‚: 14:00      â†’ Ğ’ Ğ‘Ğ”: 14:00 Athens = 11:00 UTC
ĞšĞ»Ğ¸ĞµĞ½Ñ‚ Ğ² Ğ“Ñ€ĞµÑ†Ğ¸Ğ¸ Ğ²Ğ¸Ğ´Ğ¸Ñ‚: 14:00   â†’ Ğ’ Ğ‘Ğ”: 14:00 Athens = 11:00 UTC  
ĞĞ´Ğ¼Ğ¸Ğ½ Ğ² Ğ£ĞºÑ€Ğ°Ğ¸Ğ½Ğµ Ğ²Ğ¸Ğ´Ğ¸Ñ‚: 14:00   â†’ Ğ’ Ğ‘Ğ”: 14:00 Athens = 11:00 UTC
```

### Ğ¢ĞµĞºÑƒÑ‰Ğ°Ñ Ñ€ĞµĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ

```javascript
// AddOrderModal.js - Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ¸Ğµ Ğ² UTC
const timeInLocal = dayjs.tz(
  `${bookDates.start} ${dayjs(startTime).format("HH:mm")}`,
  "YYYY-MM-DD HH:mm",
  "Europe/Athens"  // Ğ˜Ğ½Ñ‚ĞµÑ€Ğ¿Ñ€ĞµÑ‚Ğ¸Ñ€ÑƒĞµĞ¼ ĞºĞ°Ğº Ğ³Ñ€ĞµÑ‡ĞµÑĞºĞ¾Ğµ
);

const timeInUTC = timeInLocal.utc().toDate(); // Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½ÑĞµĞ¼ Ğ² UTC
```

### âš¡ Ğ ĞµĞºĞ¾Ğ¼ĞµĞ½Ğ´ÑƒĞµĞ¼Ğ°Ñ ÑÑ‚Ğ°Ğ½Ğ´Ğ°Ñ€Ñ‚Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ

#### Ğ’Ğ°Ñ€Ğ¸Ğ°Ğ½Ñ‚ A: Ğ¥Ñ€Ğ°Ğ½ĞµĞ½Ğ¸Ğµ Ğ² UTC (Ñ‚ĞµĞºÑƒÑ‰Ğ¸Ğ¹ Ğ¿Ğ¾Ğ´Ñ…Ğ¾Ğ´)
```
Ğ‘Ğ”: UTC
Frontend â†’ Backend: ĞºĞ¾Ğ½Ğ²ĞµÑ€Ñ‚Ğ°Ñ†Ğ¸Ñ Ğ² UTC
Backend â†’ Frontend: ĞºĞ¾Ğ½Ğ²ĞµÑ€Ñ‚Ğ°Ñ†Ğ¸Ñ Ğ² Athens
```

#### Ğ’Ğ°Ñ€Ğ¸Ğ°Ğ½Ñ‚ B: Ğ¥Ñ€Ğ°Ğ½ĞµĞ½Ğ¸Ğµ Ğ² Athens (Ñ€ĞµĞºĞ¾Ğ¼ĞµĞ½Ğ´ÑƒĞµÑ‚ÑÑ Ğ´Ğ»Ñ Ğ¿Ñ€Ğ¾ÑÑ‚Ğ¾Ñ‚Ñ‹)
```
Ğ‘Ğ”: Athens timezone
Frontend â†’ Backend: ĞºĞ°Ğº ĞµÑÑ‚ÑŒ
Backend â†’ Frontend: ĞºĞ°Ğº ĞµÑÑ‚ÑŒ
```

### Middleware Ğ´Ğ»Ñ ÑÑ‚Ğ°Ğ½Ğ´Ğ°Ñ€Ñ‚Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¸

```javascript
// middleware/timezone.js

const BUSINESS_TIMEZONE = "Europe/Athens";

export function normalizeToBusinessTime(date) {
  return dayjs(date).tz(BUSINESS_TIMEZONE);
}

export function formatForDisplay(date) {
  return dayjs(date).tz(BUSINESS_TIMEZONE).format("DD.MM.YYYY HH:mm");
}

export function parseFromInput(dateStr, timeStr) {
  return dayjs.tz(
    `${dateStr} ${timeStr}`,
    "YYYY-MM-DD HH:mm",
    BUSINESS_TIMEZONE
  );
}
```

### ĞšĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚ Ğ´Ğ»Ñ Ğ¾Ñ‚Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ñ Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ¸

```javascript
// components/common/BusinessTime.js

export function BusinessTime({ date, format = "HH:mm" }) {
  const businessTime = dayjs(date).tz("Europe/Athens");
  return <span>{businessTime.format(format)}</span>;
}
```

---

## Ğ”Ğ¸Ğ°Ğ³Ñ€Ğ°Ğ¼Ğ¼Ğ° Ğ¿Ğ¾Ñ‚Ğ¾ĞºĞ°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ĞĞĞ§ĞĞ›Ğ: Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Ğ·Ğ°ĞºĞ°Ğ·Ğ°                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚  Ğ’Ñ‹Ğ±Ğ¾Ñ€ Ğ´Ğ°Ñ‚ Ğ² CalendarPicker   â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚  analyzeDates(carOrders)      â”‚
              â”‚  â†’ confirmed[] + pending[]    â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚                               â”‚
              â–¼                               â–¼
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚ ĞšĞ›Ğ˜Ğ•ĞĞ¢         â”‚            â”‚ ĞĞ”ĞœĞ˜Ğ          â”‚
     â”‚ Ğ‘Ğ»Ğ¾ĞºĞ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ    â”‚            â”‚ ĞŸĞ¾ĞºĞ°Ğ·Ğ°Ñ‚ÑŒ Ğ²ÑĞµ   â”‚
     â”‚ confirmed      â”‚            â”‚ Ñ Ñ†Ğ²ĞµÑ‚Ğ°Ğ¼Ğ¸      â”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚                               â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚  Ğ’Ñ‹Ğ±Ğ¾Ñ€ Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ¸ Ğ² TimePicker   â”‚
              â”‚  validateStartTime()          â”‚
              â”‚  validateEndTime()            â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚  handleBookingComplete()      â”‚
              â”‚  â†’ ĞÑ‚Ğ¿Ñ€Ğ°Ğ²ĞºĞ° Ğ½Ğ° backend        â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚  /api/order/add               â”‚
              â”‚  checkConflicts()             â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                     â”‚                     â”‚
        â–¼                     â–¼                     â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚  409    â”‚          â”‚  202    â”‚          â”‚  200    â”‚
   â”‚ Ğ‘Ğ›ĞĞš    â”‚          â”‚ WARNING â”‚          â”‚ SUCCESS â”‚
   â”‚ Confirmedâ”‚          â”‚ Pending â”‚          â”‚ Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½  â”‚
   â”‚ conflictâ”‚          â”‚ conflictâ”‚          â”‚         â”‚
   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
        â”‚                     â”‚                     â”‚
        â–¼                     â–¼                     â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ ĞŸĞ¾ĞºĞ°Ğ·Ğ°Ñ‚ÑŒâ”‚          â”‚ Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ â”‚          â”‚ Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ â”‚
   â”‚ Ğ¾ÑˆĞ¸Ğ±ĞºÑƒ  â”‚          â”‚ Ğ·Ğ°ĞºĞ°Ğ· + â”‚          â”‚ Ğ·Ğ°ĞºĞ°Ğ·   â”‚
   â”‚         â”‚          â”‚ warning â”‚          â”‚         â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Ğ¤Ğ°Ğ¹Ğ»Ñ‹ ÑĞ¸ÑÑ‚ĞµĞ¼Ñ‹

| Ğ¤Ğ°Ğ¹Ğ» | ĞĞ°Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ |
|------|------------|
| `app/components/CarComponent/BookingModal.js` | Ğ¤Ğ¾Ñ€Ğ¼Ğ° ĞºĞ»Ğ¸ĞµĞ½Ñ‚Ğ° |
| `app/components/Admin/Order/AddOrderModal.js` | Ğ¤Ğ¾Ñ€Ğ¼Ğ° Ğ°Ğ´Ğ¼Ğ¸Ğ½Ğ° |
| `app/components/Admin/Order/EditOrderModal.js` | Ğ ĞµĞ´Ğ°ĞºÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ |
| `app/components/Calendars/CalendarPicker.js` | Ğ’Ñ‹Ğ±Ğ¾Ñ€ Ğ´Ğ°Ñ‚ |
| `app/components/Calendars/MuiTimePicker.js` | Ğ’Ñ‹Ğ±Ğ¾Ñ€ Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ¸ |
| `utils/analyzeDates.js` | ĞĞ½Ğ°Ğ»Ğ¸Ğ· Ğ´Ğ°Ñ‚ Ğ¸ ĞºĞ¾Ğ½Ñ„Ğ»Ğ¸ĞºÑ‚Ğ¾Ğ² |
| `utils/action.js` | API Ğ²Ñ‹Ğ·Ğ¾Ğ²Ñ‹ |
| `app/api/order/add/route.js` | API ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ñ Ğ·Ğ°ĞºĞ°Ğ·Ğ° |
| `app/api/order/update/*/route.js` | API Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ñ |
| `models/order.js` | Mongoose ÑÑ…ĞµĞ¼Ğ° Ğ·Ğ°ĞºĞ°Ğ·Ğ° |
| `models/car.js` | Mongoose ÑÑ…ĞµĞ¼Ğ° Ğ¼Ğ°ÑˆĞ¸Ğ½Ñ‹ |

---

*Ğ”Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ°Ñ†Ğ¸Ñ Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ°: Ğ¯Ğ½Ğ²Ğ°Ñ€ÑŒ 2026*

